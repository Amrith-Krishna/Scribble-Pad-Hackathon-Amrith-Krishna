{
  "metadata": {
    "name": "New JSNB",
    "language_info": {
      "name": "JavaScipt",
      "version": "8.0"
    }
  },
  "jsnbversion": "v0.1",
  "cells": [
    {
      "code": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Pirate Game</title>\n    <style>\n        body {\n            position: relative;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            background-color: #f0f0f0;\n            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;\n        }\n    </style>\n</head>\n<body>\n    <canvas id = \"gameCanvas\" width = \"1070px\" height = \"540px\"></canvas>\n    <button id = \"button\">LOADING...</button>\n    <style>\n\t  canvas {\n\t\t  \twidth = 1060px;\n\t\t\theight = 400px;\n            border: 2px solid #333;\n            background-image : url(\"https://www.shutterstock.com/image-vector/pixel-tropical-beach-waves-background-600nw-2291134559.jpg\");\n\t\tbackground-size: cover;\n\t\tbackground-position: left bottom;\n        }\n        button{\n            position: relative;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            width: 160px;\n            height: 30px;\n            padding: 30px 10px;\n            margin: 0% 450px;\n            border: 2px solid #000000;\n            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);\n            border-radius: 20px;\n            background-color: #FFE5B4 ;\n            font-family: 'Courier New';\n            font-weight: 500;\n            font-size: larger;\n        }\n    </style>\n</body>\n</html>",
      "status": "",
      "output": "\n\n\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Pirate Game</title>\n    <style>\n        body {\n            position: relative;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            background-color: #f0f0f0;\n            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;\n        }\n    </style>\n\n\n    <canvas id=\"gameCanvas\" width=\"1070px\" height=\"540px\"></canvas>\n    <button id=\"button\" style=\"font-weight: bold; font-size: x-large; background: rgb(255, 190, 84);\">SCORE: 1</button>\n    <style>\n\t  canvas {\n\t\t  \twidth = 1060px;\n\t\t\theight = 400px;\n            border: 2px solid #333;\n            background-image : url(\"https://www.shutterstock.com/image-vector/pixel-tropical-beach-waves-background-600nw-2291134559.jpg\");\n\t\tbackground-size: cover;\n\t\tbackground-position: left bottom;\n        }\n        button{\n            position: relative;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            width: 160px;\n            height: 30px;\n            padding: 30px 10px;\n            margin: 0% 450px;\n            border: 2px solid #000000;\n            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);\n            border-radius: 20px;\n            background-color: #FFE5B4 ;\n            font-family: 'Courier New';\n            font-weight: 500;\n            font-size: larger;\n        }\n    </style>\n\n",
      "type": "html"
    },
    {
      "code": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Pirate</title>\n\t<h1>Rules</h1>\n</head>\n<body>\n\t  <line>1. Move your hand to the upper half of the screen to jump. A jump cannot be stopped once initiated.<br>If the hand is in the lower half of the screen and the character is jumping, the character starts<br> falling faster.<br>\n\t2. Move your hand to the left of the screen to move left. The further to the left, the higher the speed,<br>up to a limit.<br>\n\t4. The character has 1 health.<br>\n\t5. If the character hits any obstacle the player loses 1 health and the game is over.<br>\n\t6. The obstacles dimensions are randomized each time an obstacle is created.<br>\n\t7. As the score increases, the game speed will increase as well as the average size of the obstacles.<br>\n\t8. Once an obstacle moves to the left edge, the score is increased and a new obstacle is created.<br>\n\t  </line>\n<style>\n\t  line {\n\t\t  font-family: 'Courier New', sans-serif;\n\t\tfont-size: larger;\n\t\tfont-weight: \"bold\";\n\t  }</body>\n</html>\n\n\n  ",
      "status": "",
      "output": "\n\n\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Pirate</title>\n\t<h1>Rules</h1>\n\n\n\t  <line>1. Move your hand to the upper half of the screen to jump. A jump cannot be stopped once initiated.<br>  If the hand is in the lower half of the screen and the character is jumping, the character starts<br>   falling faster.<br>\n\t2. Move your hand to the left of the screen to move left. The further to the left, the higher the speed,<br>   up to a limit.<br>\n\t4. The character has 1 health.<br>\n\t5. If the character hits any obstacle the player loses 1 health and the game is over.<br>\n\t6. The obstacles dimensions are randomized each time an obstacle is created.<br>\n\t7. As the score increases, the game speed will increase as well as the average size of the obstacles.<br>\n\t8. Once an obstacle moves to the left edge, the score is increased and a new obstacle is created.<br>\n\t  </line>\n<style>\n\t  line {\n\t\t  font-family: 'Courier New', sans-serif;\n\t\tfont-size: larger;\n\t\tfont-weight: \"bold\";\n\t  }</body>\n</html>\n\n\n\n  </style>",
      "type": "html"
    },
    {
      "code": "await import(\"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs\")\nawait import(\"https://cdn.jsdelivr.net/npm/@tensorflow-models/handpose\")\nawait import(\"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl\")\n\nconst video = document.createElement('video');\nconst canvas = document.getElementById('gameCanvas');\nconst ctx = canvas.getContext('2d');\nconst start = document.getElementById('button');\nconst heart = new Image();\nheart.src = \"https://imgs.search.brave.com/4wzDs80cBO6f0yhP-a6Aaf6I2WmPPP0P2Ul5wTBR_co/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly93d3cu/cG5nYWxsLmNvbS93/cC1jb250ZW50L3Vw/bG9hZHMvMTUvTWlu/ZWNyYWZ0LUhlYXJ0/LVBORy1DdXRvdXQu/cG5n\";\nconst charimage = new Image();\ncharimage.src = \"https://preview.redd.it/48x48-pirate-sprite-for-a-videogame-i-am-trying-to-find-a-v0-fghbq7x5jnzc1.png?auto=webp&s=6e5dcd2479f84fb4b00222ead3ce4c5cda15f2da\";\nconst obstimage = new Image();\nobstimage.src = \"https://w7.pngwing.com/pngs/236/347/png-transparent-minecraft-pocket-edition-mod-minecraft-tnt-s-text-orange-logo-thumbnail.png\";\nconst gameover = new Image();\ngameover.src = \"https://pngimg.com/uploads/game_over/game_over_PNG33.png\";\n\nlet model, handData;\nlet objectX = canvas.width / 2;\nlet objectY = canvas.height / 2;\n\n\n// Player Character attributes\nconst character = {\n    x: 50,\n    y: canvas.height - 75,\n    width: 90,\n    height: 135,\n  \thealth: 1,\n    color: \"#ff6347\",\n    speed: 5,\n    jumpStrength: 25,\n    isJumping: false,\n    dy: 0\n};\n\n// Obstacle attributes\nconst obstacle = {\n    x: canvas.width,\n    y: canvas.height - 40,\n    width: 80,\n    height: 80,\n    color: \"#333\",\n    speed: canvas.width/200,\n  \tspeedmult: 1.0\n};\n\n// Game status\nlet score = 0;\nlet gameRunning = true;\n\n// Web-cam access\n// Edit -> Trust NB\nasync function startVideo() {\n    const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n    video.srcObject = stream;\n    video.play();\n}\n\n// Sets up the Hand gesture detection model\nasync function initmodel() {\n    model = await handpose.load();\n    startVideo();\n    detectHands();\n    window.alert(\"Webcam access received, Ready to play!\");\n    start.innerText = \"START\";\n  \tstart.style.fontWeight = \"bold\";\n  \tstart.style.fontSize = \"x-large\";\n    start.style.background = \"#ff7f00\";\n    start.addEventListener('click', () =>{\n\t  start.innerText = \"RESTART\";\n\t  start.style.background = \"#FFBE54\";\n\t  init();\n\t});\n}\n\n// Utility function\nfunction randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\n// Calls the hand gesture detector\nasync function detectHands() {\n    if (video.readyState === video.HAVE_ENOUGH_DATA) {\n        handData = await model.estimateHands(video);\n    }\n    requestAnimationFrame(detectHands);\n}\n\n// Updates the hand position information\nfunction updatePosition() {\n    if (handData && handData.length > 0) {\n\t  // Reference point is tip of index finger\n        const indexFinger = handData[0].landmarks[8];\n        objectX = (indexFinger[0] / video.videoWidth) * canvas.width;\n        objectX = canvas.width - objectX;\n        objectY = (indexFinger[1] / video.videoHeight) * canvas.height;\n    }\n}\n\n//Initialize player, score and obstacles\nfunction init() {\n    objectX = canvas.width / 2;\n    objectY = canvas.height / 2;\n    character.x = 50;\n    character.y = canvas.height - character.height;\n    character.isJumping = false;\n    character.dy = 0;\n  \tcharacter.speed = 5;\n    obstacle.x = canvas.width;\n    obstacle.width = Math.floor(2.2*score) + randomInt(60,100);\n    obstacle.height = Math.floor(2.4*score) + randomInt(60,90);\n    obstacle.y = canvas.height - obstacle.height;\n  \tobstacle.speed = canvas.width/200;\n  \tobstacle.speedmult = 1.0;\t\n  \tscore = 0;\n    gameRunning = true;\n    gameLoop();\n}\n\n// Game loop\nfunction gameLoop() {\n    if (gameRunning) {\n        updatePosition();\n        update();\n        draw();\n        requestAnimationFrame(gameLoop);\n    } else {\n        ctx.fillStyle = \"black\";\n        ctx.font = \"50px Times New Roman\";\n\t  \tstart.innerText = \"SCORE: \"+score;\n\t    ctx.drawImage(gameover, canvas.width / 4, canvas.height / 4, canvas.width / 2, canvas.height/1.5);\n\t    requestAnimationFrame(gameLoop);\n    }\n}\n\n\n// Update game objects\nfunction update() {\n    // Character movement based on hand position\n    // Upper half -> jump\n  \t// Left -> move left\n    // Right -> move right\n  \t\n  \tif (detectCollision(character, obstacle)) {\n        character.health -= 1;\n\t  \tif(character.health <= 0) {\n\t\t  gameRunning = false;\n\t\t  gameLoop();\n\t\t}\n\t  \telse init();\n    }\n  \n    if (objectX < canvas.width/2 && character.x > 0) character.x -= character.speed * Math.min(1.0,2*objectX/canvas.height);\n    if (objectX > canvas.width/2 && character.x + character.width < canvas.width) character.x += character.speed * Math.min(1.0,2*objectX/canvas.height);\n    if (objectY < canvas.height/2 && !character.isJumping) {\n        character.isJumping = true;\n        character.dy = -character.jumpStrength;\n    }\n  \tif(objectY >= canvas.height/2 && character.isJumping) character.dy += character.jumpStrength/5;\n\n    // Gravity\n    character.dy += 1;\n    character.y += character.dy;\n    if (character.y + character.height > canvas.height - 1) {\n        character.y = canvas.height - character.height;\n        character.isJumping = false;\n        character.dy = 0;\n    }\n\n    // Move obstacle\n    obstacle.x -= obstacle.speed;\n    if (obstacle.x < 0) {\n        obstacle.x = canvas.width;\n        obstacle.width = Math.floor(2.2*score) + randomInt(60,100);\n        obstacle.height = Math.floor(2.4*score) + randomInt(60,90);\n        obstacle.y = canvas.height - obstacle.height;\n\n        score += 1; \n\t  // Increment score each time obstacle is avoided\n\t  \tif(gameRunning){\n        \t\tobstacle.speed *= 1.03; \n\t  \t\t\tobstacle.speedmult *= 1.03;\n\t\t}\n\t  // Gradually increase speed for difficulty\n    }\n\n    // Check collision\n}\n\n// Draw game objects\nfunction draw() {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // Draw character\n    ///ctx.fillStyle = character.color;\n    ctx.drawImage(charimage, character.x, character.y, character.width, character.height);\n\n    // Draw obstacle\n    ///ctx.fillStyle = obstacle.color;\n    ctx.drawImage(obstimage, obstacle.x, obstacle.y, obstacle.width, obstacle.height);\n\n    // Draw axes for the player's convenience\n    ctx.fillStyle = \"#000000\";\n    ctx.fillRect(canvas.width/2, 0, 1, canvas.height);\n    ctx.fillRect(0, canvas.height/2, canvas.width, 1);\n\n    // Draw score\n    ctx.fillStyle = \"#000000\";\n    ctx.font = \"bold 30px Courier New\";\n    ctx.fillText(\"Score: \" + score, 10, 30);\n  \tctx.fillText(\"Speed: \" + Math.round(obstacle.speedmult*100)/100, 10, 60);\n    ctx.beginPath();\n    ctx.arc(objectX, objectY, 8, 0, Math.PI * 2);\n    ctx.fillStyle = \"black\";\n    ctx.fill();\n    ctx.closePath();\n  \n  \tfor(let i = 0; i < character.health; i+=1){\n\t  \tctx.drawImage(heart, canvas.width - 46 - i*36, 10, 40, 40);\n\t}\n    requestAnimationFrame(draw);\n}\n\n// Collision detection between obstacles and player\nfunction detectCollision(rect1, rect2) {\n    return (\n        rect1.x < rect2.x + rect2.width &&\n        rect1.x + rect1.width > rect2.x &&\n        rect1.y < rect2.y + rect2.height &&\n        rect1.y + rect1.height > rect2.y\n    );\n}\n\n// Start the game\ninitmodel();",
      "status": "[15]<br><span style=\"font-size:8px\">471ms<span></span></span>",
      "output": "",
      "type": "code"
    }
  ],
  "source": "https://github.com/gopi-suvanam/jsnb",
  "run_on_load": false
}